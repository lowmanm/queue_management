<header class="workspace-header">
  <div class="header-left">
    <h1 class="app-title">Nexus Queue</h1>

    <!-- Navigation Links -->
    <nav class="main-nav">
      <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-link">
        Workspace
      </a>
      @if (canAccessManager) {
        <a routerLink="/manager/team" routerLinkActive="active" class="nav-link">
          Team
        </a>
        <a routerLink="/manager/queues" routerLinkActive="active" class="nav-link">
          Queues
        </a>
        <a routerLink="/manager/queue-config" routerLinkActive="active" class="nav-link">
          Queue Config
        </a>
      }
      @if (canAccessDesigner) {
        <a routerLink="/admin/task-sources" routerLinkActive="active" class="nav-link">
          Task Sources
        </a>
        <a routerLink="/admin/dispositions" routerLinkActive="active" class="nav-link">
          Dispositions
        </a>
        <a routerLink="/admin/logic-builder" routerLinkActive="active" class="nav-link">
          Logic Builder
        </a>
      }
      @if (canAccessAdmin) {
        <a routerLink="/admin/users" routerLinkActive="active" class="nav-link">
          Users
        </a>
      }
    </nav>
  </div>

  <div class="header-center">
    @if (headerStats$ | async; as stats) {
      <div class="session-metrics">
        <div class="metric">
          <span class="metric-value">{{ stats.tasksCompleted }}</span>
          <span class="metric-label">Completed</span>
        </div>
        <div class="metric">
          <span class="metric-value">{{ stats.avgHandleTime }}</span>
          <span class="metric-label">Avg Handle</span>
        </div>
        <div class="metric">
          <span class="metric-value">{{ stats.loggedInTime }}</span>
          <span class="metric-label">Session</span>
        </div>
        <div class="metric">
          <span class="metric-value">{{ stats.tasksPerHour }}</span>
          <span class="metric-label">Tasks/Hr</span>
        </div>
      </div>
    }
  </div>

  <div class="header-right">
    <!-- Agent Work State Controls -->
    <app-agent-controls></app-agent-controls>

    @if (user$ | async; as user) {
      <div class="user-info">
        <span class="user-name">{{ user.displayName }}</span>

        <!-- Role Badge with Switcher -->
        <div class="role-wrapper">
          <button
            class="role-badge"
            [class.active]="showRoleSwitcher"
            (click)="toggleRoleSwitcher()"
            title="Switch Role (Demo)"
          >
            {{ currentRoleLabel }}
          </button>

          @if (showRoleSwitcher) {
            <div class="role-dropdown">
              @for (role of roles; track role) {
                <button
                  class="role-option"
                  [class.selected]="user.role === role"
                  (click)="switchRole(role)"
                >
                  {{ role }}
                </button>
              }
            </div>
          }
        </div>
      </div>
    }

    <button class="debug-btn" (click)="onToggleLogs()" title="View Debug Logs">
      Logs
    </button>
  </div>
</header>
